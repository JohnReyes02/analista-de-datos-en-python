{
  "hash": "2d7f93f06f076fafb388f683f78273fa",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Relaciones en los datos\"\n---\n\nLas variables de los conjuntos de datos tienen relaciones entre sí. En este capítulo, examinarás las relaciones entre datos numéricos, categóricos e incluso DateTime, explorando la dirección y la fuerza de estas relaciones, así como las formas de visualizarlas.\n\n## Patrones a lo largo del tiempo\n\n::: {#8ae8364c .cell execution_count=1}\n``` {.python .cell-code}\ndivorce = pd.read_csv(\"divorce.csv\")\ndivorce.head()\n```\n:::\n\n\n![](images/paste-53.png)\n\n-   Importando data DateTime\n\n    -   DataTime necesita ser explicitamente declarada en pandas\n\n::: {#725b0065 .cell execution_count=2}\n``` {.python .cell-code}\ndivorce.dtypes\n```\n:::\n\n\n![](images/paste-54.png)\n\n::: {#90d7eab6 .cell execution_count=3}\n``` {.python .cell-code}\ndivorce = pd.read_csv(\"divorce.csv\", parse_dates=[\"marriage_date\"])\ndivorce.dtypes\n```\n:::\n\n\n![Este tipo de datos abre muchas posibilidades para el análisis, como observar patrones a lo largo de años, meses o incluso días de la semana.](images/paste-55.png)\n\n-   Conviritiendo los datos a DataTime\n\n    -   `pd.to_datetime()` convierte los argumentos de datos DateTime\n\n::: {#4bc312ec .cell execution_count=4}\n``` {.python .cell-code}\ndivorce['marriage_date'] = pd.to_datetime(divorce['marriage_date'])\ndivorce_dtypes\n```\n:::\n\n\n![](images/paste-57.png)\n\n-   Creando datos DateTime\n\n::: {#3c9b3598 .cell execution_count=5}\n``` {.python .cell-code}\ndivorce.head(2)\n```\n:::\n\n\n![](images/paste-58.png)\n\n::: {#5579a0d3 .cell execution_count=6}\n``` {.python .cell-code}\ndivorce['marriage_date'] = pd.to_datetime(divorce[['month', 'day', 'year']])\ndivorce.head(2)\n```\n:::\n\n\n![](images/paste-59.png)\n\nEs posible extraer sólo el mes, el día o el año de una columna que contenga una fecha completa, usando los atributos `dt.month`, `dt.day` y `dt.year.`\n\n::: {#901e968d .cell execution_count=7}\n``` {.python .cell-code}\ndivorce['marriage_month'] = divorce['marriage_date'].dt.month()\ndivorce.head()\n```\n:::\n\n\n![](images/paste-60.png)\n\n-   Visualizando patrones a lo largo del tiempo\n\n::: {#9951f997 .cell execution_count=8}\n``` {.python .cell-code}\nsns.lineplot(data=divorce, x='marriage_month', y='marriage_duration')\nplt.show()\n```\n:::\n\n\n![](images/paste-61.png)\n\nLos amplios intervalos de confianza sugieren que se necesita más análisis.\n\n### Importar datos DateTime\n\n¡Ahora trabajarás con todo el conjunto de datos del divorcio! Los datos desciben los matrimonios mexicanos disueltos entre 2000 y 2015. Contiene las fechs de matrimonio y divorcio, el nivel educativo, la fecha de nacimiento, los ingresos de cada miembro de la pareja y la duración del matrimonio, así como el número de hijos que tenía la pareja en el momento del divorcio.\n\nLos nombres de ls columnas y los tipos de datos son los siguientes:\n\n![](images/paste-62.png)\n\n¡Parece que hay mucha información de fecha en estos datos que todavía no son de tipo DateTime! Tu tarea es arreglarlo para que puedas explorar patrones a lo largo del tiempo.\n\n::: {#e1b79b80 .cell execution_count=9}\n``` {.python .cell-code}\nimport pandas as pd\n\nruta = './data/divorce.csv'\ndivorce = pd.read_csv(ruta)\ndivorce.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>divorce_date</th>\n      <th>dob_man</th>\n      <th>education_man</th>\n      <th>income_man</th>\n      <th>dob_woman</th>\n      <th>education_woman</th>\n      <th>income_woman</th>\n      <th>marriage_date</th>\n      <th>marriage_duration</th>\n      <th>num_kids</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2006-09-06</td>\n      <td>1975-12-18</td>\n      <td>Secondary</td>\n      <td>2000.0</td>\n      <td>1983-08-01</td>\n      <td>Secondary</td>\n      <td>1800.0</td>\n      <td>2000-06-26</td>\n      <td>5.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2008-01-02</td>\n      <td>1976-11-17</td>\n      <td>Professional</td>\n      <td>6000.0</td>\n      <td>1977-03-13</td>\n      <td>Professional</td>\n      <td>6000.0</td>\n      <td>2001-09-02</td>\n      <td>7.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2011-01-02</td>\n      <td>1969-04-06</td>\n      <td>Preparatory</td>\n      <td>5000.0</td>\n      <td>1970-02-16</td>\n      <td>Professional</td>\n      <td>5000.0</td>\n      <td>2000-02-02</td>\n      <td>2.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2011-01-02</td>\n      <td>1979-11-13</td>\n      <td>Secondary</td>\n      <td>12000.0</td>\n      <td>1981-05-13</td>\n      <td>Secondary</td>\n      <td>12000.0</td>\n      <td>2006-05-13</td>\n      <td>2.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2011-01-02</td>\n      <td>1982-09-20</td>\n      <td>Professional</td>\n      <td>6000.0</td>\n      <td>1988-01-30</td>\n      <td>Professional</td>\n      <td>10000.0</td>\n      <td>2007-08-06</td>\n      <td>3.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Instrucciones\n\n-   Importa `divorce.csv`, guardando como DataFrame, `divorce`: indica en la función de importación que las columnas `divorce_date`, `dob_man`, `dob_woman`, y `marriage_date` deben importarse como valores DateTime.\n\n::: {#edbada1f .cell execution_count=10}\n``` {.python .cell-code}\n# Import divorce.csv, parseing the appropriate columns as dateds in the import\ndivorce = pd.read_csv('./data/divorce.csv', parse_dates=['divorce_date', 'dob_man', 'dob_woman', 'marriage_date'])\nprint(divorce.dtypes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndivorce_date         datetime64[ns]\ndob_man              datetime64[ns]\neducation_man                object\nincome_man                  float64\ndob_woman            datetime64[ns]\neducation_woman              object\nincome_woman                float64\nmarriage_date        datetime64[ns]\nmarriage_duration           float64\nnum_kids                    float64\ndtype: object\n```\n:::\n:::\n\n\nBuen trabajo parseando esas fechas al mismo tiempo que importabas los datos en pandas. ¡Ahora, intenta actualizar los tipos de datos DateTime en una DataFrame que ya ha sido importado!\n\n### Actualizar tipo de datos a DateTime\n\nAhora se te ha cargado el DataFrame `divorce`, pero una columna se almacea como una cadena que debería ser un dato DateTime. ¿Cuál es? Una vez que hayas identificado la columna, la actualizarás para que puedas explorarla más de cerca en el siguiente ejercicio.\n\n::: {#e3932b98 .cell execution_count=11}\n``` {.python .cell-code}\nruta = './data/divorce.csv'\ndivorce = pd.read_csv(ruta, parse_dates=['divorce_date', 'dob_man', 'dob_woman'])\nprint(divorce.dtypes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndivorce_date         datetime64[ns]\ndob_man              datetime64[ns]\neducation_man                object\nincome_man                  float64\ndob_woman            datetime64[ns]\neducation_woman              object\nincome_woman                float64\nmarriage_date                object\nmarriage_duration           float64\nnum_kids                    float64\ndtype: object\n```\n:::\n:::\n\n\n#### Instrucciones\n\n1.  **Pregunta**\n\n¿Cuál de las columnas del DataFrame `divorce` no se ha actualizado a un tipo de datos DateTime, pero debería hacerse?\n\n**Respuestas posibles**\n\n-   [ ] `divorce_date`\n-   [x] `marriage_date`\n-   [ ] `education_woman`\n-   [ ] `num_kids`\n\n2.  Covierte la columna `marriage_date` del DataFrame `divorce` en valores de `DateTime`.\n\n::: {#ee820aef .cell execution_count=12}\n``` {.python .cell-code}\n# Convert the marriage_date column to DateTime values\ndivorce['marriage_date'] = pd.to_datetime(divorce['marriage_date'])\nprint(divorce.dtypes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndivorce_date         datetime64[ns]\ndob_man              datetime64[ns]\neducation_man                object\nincome_man                  float64\ndob_woman            datetime64[ns]\neducation_woman              object\nincome_woman                float64\nmarriage_date        datetime64[ns]\nmarriage_duration           float64\nnum_kids                    float64\ndtype: object\n```\n:::\n:::\n\n\nAhora, estás listo para ver cómo la fecha de matrimonio de una pareja se relaciona con otros datos.\n\n### Visualizar las relaciones a lo largo del tiempo\n\nAhora que tus datos de fechas se guardan como datos DateTime, ¡puedes explorar patrones a lo largo del tiempo! ¿Tiene relación el año en que se casó una pareja con el número de hijos que tiene en el momento del divorcio? ¡Tu tarea es averiguarlo!\n\n#### Instrucciones\n\n1.  Define una columna llamada `marriage_year`, que solo contiene la parte del año de la columna `marriage_date`.\n\n::: {#2239536e .cell execution_count=13}\n``` {.python .cell-code}\n# Define the marriage_year column\ndivorce['marriage_year'] = divorce['marriage_date'].dt.year\n```\n:::\n\n\n2.  Crea un gráfico de líneas que muestre el número medio de hijos que tuvo una pareja durante su matrimonio, ordenado por el año en que la pareja se casó.\n\n::: {#b8a08fc2 .cell execution_count=14}\n``` {.python .cell-code}\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n# Create a lineplot showing the average  number of kids by year\nsns.lineplot(data=divorce, x='marriage_year', y='num_kids')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-15-output-1.png){}\n:::\n:::\n\n\n¡Bien hecho! Haz descubierto un patrón aquí, parece que las parejas que se casaron en años posteriores también tuvieron menos hijos durante su matrimonio.\n\n## Correlación\n\n-   Correlación\n    -   Describe la dirección de la relación de entre dos variables así como su fuerza.\n\n    -   Configurar `numeric_only=True` previene errores con columnas no numéricas.\n\n    -   El método `.cor()` calcula el coeficiente de correlación de Pearson.\n\n::: {#d9cd6a86 .cell execution_count=15}\n``` {.python .cell-code}\ndivorce.corr(numeric_only=True)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>income_man</th>\n      <th>income_woman</th>\n      <th>marriage_duration</th>\n      <th>num_kids</th>\n      <th>marriage_year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>income_man</th>\n      <td>1.000000</td>\n      <td>0.318047</td>\n      <td>0.085321</td>\n      <td>0.040848</td>\n      <td>0.019170</td>\n    </tr>\n    <tr>\n      <th>income_woman</th>\n      <td>0.318047</td>\n      <td>1.000000</td>\n      <td>0.078677</td>\n      <td>-0.018015</td>\n      <td>0.026433</td>\n    </tr>\n    <tr>\n      <th>marriage_duration</th>\n      <td>0.085321</td>\n      <td>0.078677</td>\n      <td>1.000000</td>\n      <td>0.447358</td>\n      <td>-0.812469</td>\n    </tr>\n    <tr>\n      <th>num_kids</th>\n      <td>0.040848</td>\n      <td>-0.018015</td>\n      <td>0.447358</td>\n      <td>1.000000</td>\n      <td>-0.461495</td>\n    </tr>\n    <tr>\n      <th>marriage_year</th>\n      <td>0.019170</td>\n      <td>0.026433</td>\n      <td>-0.812469</td>\n      <td>-0.461495</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n-   Mapas de calor de correlación\n\n::: {#e97f00a5 .cell execution_count=16}\n``` {.python .cell-code}\nsns.heatmap(divorce.corr(numeric_only=True), annot=True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-17-output-1.png){}\n:::\n:::\n\n\n-   Correlación en contexto\n\n::: {#ce18da0a .cell execution_count=17}\n``` {.python .cell-code}\ndivorce['divorce_date'].min()\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\nTimestamp('2000-01-08 00:00:00')\n```\n:::\n:::\n\n\n::: {#115d8c12 .cell execution_count=18}\n``` {.python .cell-code}\ndivorce['divorce_date'].max()\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nTimestamp('2015-11-03 00:00:00')\n```\n:::\n:::\n\n\n-   Visualización de las relaciones\n    - Es importante complementar nuestros cálculos de correlación con gráficos de dispersión.\n\n+-----------------------------------------------------------+------------------------------------------------------+\n| ![](images/paste-64.png)                                  | ![](images/paste-65.png)                             |\n+-----------------------------------------------------------+------------------------------------------------------+\n| -   Fuerte relación, pero no lineal                       | -   Relación cuadrática; no lineal                   |\n|                                                           |                                                      |\n| -   El coeficiente de correlación de Pearson: `-6.48e-18` | -   Coeficiente de correlación de Pearson: `.971211` |\n+-----------------------------------------------------------+------------------------------------------------------+\n\n\n- Scatter plots\n\n::: {#0fbe8219 .cell execution_count=19}\n``` {.python .cell-code}\nsns.scatterplot(data=divorce, x='income_man', y='income_woman')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-20-output-1.png){}\n:::\n:::\n\n\n- Pairplots\n    - Es útil para obtener una descripción general rápida de las relaciones dentro del conjunto de datos.\n    - Tanta información en un elemento visual puede ser difícil de interpretar con grandes conjuntos de datos.\n\n::: {#f45664ee .cell execution_count=20}\n``` {.python .cell-code}\nsns.pairplot(data=divorce)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-21-output-1.png){}\n:::\n:::\n\n\nEs posible limitar el número de relaciones graficadas estableciendo el argumento `vars` igual a las variables de interés.\n\n::: {#1c73eae6 .cell execution_count=21}\n``` {.python .cell-code}\nsns.pairplot(data=divorce, vars=['income_man', 'income_woman', 'marriage_duration'])\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-22-output-1.png){}\n:::\n:::\n\n\n### Interpretar un mapa de calor\n\n¿Cuál de las siguientes afirmaciones es correcta respecto a las relaciones entre variables en el DataFrame `divorce`?\n\n::: {#39516fa1 .cell execution_count=22}\n``` {.python .cell-code}\ndivorce['marriage_moth'] = divorce['marriage_date'].dt.month\ndivorce.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>divorce_date</th>\n      <th>dob_man</th>\n      <th>education_man</th>\n      <th>income_man</th>\n      <th>dob_woman</th>\n      <th>education_woman</th>\n      <th>income_woman</th>\n      <th>marriage_date</th>\n      <th>marriage_duration</th>\n      <th>num_kids</th>\n      <th>marriage_year</th>\n      <th>marriage_moth</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2006-09-06</td>\n      <td>1975-12-18</td>\n      <td>Secondary</td>\n      <td>2000.0</td>\n      <td>1983-08-01</td>\n      <td>Secondary</td>\n      <td>1800.0</td>\n      <td>2000-06-26</td>\n      <td>5.0</td>\n      <td>1.0</td>\n      <td>2000</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2008-01-02</td>\n      <td>1976-11-17</td>\n      <td>Professional</td>\n      <td>6000.0</td>\n      <td>1977-03-13</td>\n      <td>Professional</td>\n      <td>6000.0</td>\n      <td>2001-09-02</td>\n      <td>7.0</td>\n      <td>NaN</td>\n      <td>2001</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2011-01-02</td>\n      <td>1969-04-06</td>\n      <td>Preparatory</td>\n      <td>5000.0</td>\n      <td>1970-02-16</td>\n      <td>Professional</td>\n      <td>5000.0</td>\n      <td>2000-02-02</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>2000</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2011-01-02</td>\n      <td>1979-11-13</td>\n      <td>Secondary</td>\n      <td>12000.0</td>\n      <td>1981-05-13</td>\n      <td>Secondary</td>\n      <td>12000.0</td>\n      <td>2006-05-13</td>\n      <td>2.0</td>\n      <td>NaN</td>\n      <td>2006</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2011-01-02</td>\n      <td>1982-09-20</td>\n      <td>Professional</td>\n      <td>6000.0</td>\n      <td>1988-01-30</td>\n      <td>Professional</td>\n      <td>10000.0</td>\n      <td>2007-08-06</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2007</td>\n      <td>8</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Instrucciones \n\n**Respuestas Posibles**\n\n- [ ] `marriage_duration` está fuertemente correlacionada de forma positiva con `marriage_month`.\n\n- [ ] La correlación entre `num_kids` y `income_man` es más fuerte que la correlación entre `num_kids` y `marriage_duration`.\n\n- [ ] Un `marriage_year` más tardío provoca un menor número de hijos, representado por `num_kids`.\n\n- [X] Un `marriage_year` más tardío está correlacionado con tener menos hijos.\n\n\n### Visualizar las relaciones entre variables\n\nEn el último ejercicio, habrás observado que un `marriage_duration` más largo está correlacionado con tener más hijos , representado por la columna `num_kids`. El coeficiente de correlación entre las variables `marriage_duration` y `num_kids` es `0.45`.\n\nEn este ejercicio, crearás un gráfico de dispersión para visualizar la relación entre estas variables.\n\n#### Instrucciones\n\n- Cree un diagrama de dispersión que muestre `marriage_duration` en el eje x y `num_kids` en el eje y.\n\n::: {#4f48fe29 .cell execution_count=23}\n``` {.python .cell-code}\n# Create the scatterplot\nsns.scatterplot(data=divorce, x='marriage_duration', y='num_kids')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-24-output-1.png){}\n:::\n:::\n\n\nHay una ligera relación positiva en el gráfico de dispersión. En el conjunto de datos, las parejas sin hijos no tienen valor en la columna `num_kids`. Si estás seguro que todos o la mayoría de los valores faltantes en `num_kids` están relacionados con parejas sin hijos, podrías considerar actualizar estos valores a 0, lo que podría aumentar la correlación.\n\n\n### Visualizar las relaciones entre múltiples variables\n\nSeaborn's `.pairplot()` es excelente para comprender las relaciones entre varias o todas las vatiables de un conjunto de datos, agregando gráficos de dispersión por pares en un solo visual.\n\nTu tarea consiste en utilizar un `pairplot` par comparar la relación entre 'marriage_duration' y 'income_woman'.\n\n#### Instrucciones\n\n- Crea un diagrama de pares para visualizar las relaciones entre `income_woman` y `marriage_duration` en el DataFrame `divorce`.\n\n::: {#7e46d249 .cell execution_count=24}\n``` {.python .cell-code}\n# Create a pairplot for income_woman and marriage_duration\nsns.pairplot(data=divorce, vars=['income_woman', 'marriage_duration'])\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-25-output-1.png){}\n:::\n:::\n\n\nAl igual que la matriz de correlación , puedes ver que la relación entre `income_woman` y `marriage_duration` no es fuerte. También puedes tener una idea de las distribuciones de ambas variables en los gráficos superior izquierdo e inferior derecho.\n\n\n## Relaciones y distribuciones de los factores\n\n- Nivel de educación: male partner\n\n::: {#400d0e7e .cell execution_count=25}\n``` {.python .cell-code}\ndivorce['education_man'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\neducation_man\nProfessional    1313\nPreparatory      501\nSecondary        288\nPrimary          100\nOther              3\nName: count, dtype: int64\n```\n:::\n:::\n\n\n- Explorando las relaciones categóricas\n\n::: {#275cb420 .cell execution_count=26}\n``` {.python .cell-code}\nsns.histplot(data=divorce, x='marriage_duration', binwidth=1)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-27-output-1.png){}\n:::\n:::\n\n\n::: {#86f67378 .cell execution_count=27}\n``` {.python .cell-code}\nsns.histplot(data=divorce, x='marriage_duration', hue='education_man', binwidth=1)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-28-output-1.png){}\n:::\n:::\n\n\n- Kernel Desnsity Estimate (KDE) plots\n\n::: {#2b12d090 .cell execution_count=28}\n``` {.python .cell-code}\nsns.kdeplot(data=divorce, x='marriage_duration', hue='education_man')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-29-output-1.png){}\n:::\n:::\n\n\nLos gráficos KDE nos permiten visualizar las distribuciones. Los KDE son más interpretables, especialmente cuando se muestran varias distribuciones.\n\nLa distribución con KDE parece sugerir que algunas parejas tuvieron duraciones menores a cero.\n\nPara solucionar esto, podempos utilizar el argumento de la palabra clave `cut`.\n\n::: {#b57bde69 .cell execution_count=29}\n``` {.python .cell-code}\nsns.kdeplot(data=divorce, x='marriage_duration', hue='education_man', cut=0)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-30-output-1.png){}\n:::\n:::\n\n\n- Gráficos KDE acumulativos\n\n::: {#3f91b36f .cell execution_count=30}\n``` {.python .cell-code}\nimport seaborn as sns\nsns.kdeplot(data=divorce, x='marriage_duration', hue='education_man', cut=0, cumulative=True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-31-output-1.png){}\n:::\n:::\n\n\nEste gráfico describe la probabilidad de que la duración del matrimonio sea menor o igual al valor del eje x para cada nivel de educación de la pareja masculina.\n\n- Relación entre la edad del matrimonio y la educación\n    - Hay una relación entre la edad al momento del matrimonio y el nivel de educación?\n\n::: {#edbbe8dd .cell execution_count=31}\n``` {.python .cell-code}\ndivorce['man_age_marriage'] = divorce['marriage_year'] - divorce['dob_man'].dt.year\ndivorce['woman_age_marriage'] = divorce['marriage_year'] - divorce['dob_woman'].dt.year\n```\n:::\n\n\n- Scatter plot con las variables categóricas\n\n::: {#43f6c9e8 .cell execution_count=32}\n``` {.python .cell-code}\nsns.catplot(data=divorce, x='woman_age_marriage', y='man_age_marriage')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-33-output-1.png){}\n:::\n:::\n\n\n::: {#433f81e0 .cell execution_count=33}\n``` {.python .cell-code}\nsns.catplot(data=divorce, x='woman_age_marriage', y='man_age_marriage', hue='education_man')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-34-output-1.png){}\n:::\n:::\n\n\n### Datos categóricos en gráficos de dispersión\n\nEn el video se exploro cómo se relacionan el nivel educativo de los hombres y la edad al casarse con otras variables de nuestro conjunto de datos, el DataFrame `divorce`. Ahora verás cómo se relacionan la formación de las mujeres y la edad al casarse con otras variables.\n\nTu tarea consiste en crear un diagrama de dispersión de la edad y los ingresos de cada mujer, incorporando la variable categórica del nivel educativo para obtener un contexto adicional.\n\n\n#### Instrucciones\n\n- Crea un gráfico de dispersión que muestre `woman_age_marriage` en el eje de abcisas y `income_woman` en el eje de las ordenadas, cada punto de datos debe colorearse en función del nivel educativo de la mujer, representado por `education_woman`.\n\n::: {#72775fc9 .cell execution_count=34}\n``` {.python .cell-code}\n# Create a scatter plot\nsns.scatterplot(data=divorce, x='woman_age_marriage', y='income_woman', hue='education_woman')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-35-output-1.png){}\n:::\n:::\n\n\nParece que hay una correlación positiva entre la educación profesional y los salarios más altos, como cabría esperar. La relación entre la edad de las mujeres al casarse y el nivel educativo es un poco menos clara.\n\n\n### Explorando con gráficos KDE\n\nLos gráficos de Estimación de Densidad del Núcleo (KDE) son una gran alternativa a los histogramas cuando quieres mostrar varias distribuciones en el mismo gráfico.\n\nSupongamos que te interesa la relación entre la duración del matrimonio y el número de hijos que tiene una pareja. Como los valores de la columna `num_kids` sólo van de uno a cinco, puedes graficar el KDE de cada valor en la misma gráfica.\n\nRecuerda que la columna `num_kids` de `divorce` solo muestra los valores `N/A` de las parejas sin hijos, por lo que solo verás las distribuciones de las parejas divorciadas con al menos un hijo.\n\n\n#### Instrucciones\n\n1.  Cree un gráfico KDE que muestre `marriage_duration` en el eje x y una línea de color diferente para cada posible número de hijos que pueda tener una pareja, representada por `num_kids`.\n\n::: {#fa36fbd9 .cell execution_count=35}\n``` {.python .cell-code}\n# Create the KDE plot\nsns.kdeplot(data=divorce, x='marriage_duration', hue='num_kids')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-36-output-1.png){}\n:::\n:::\n\n\n2. Observa que actualmente el gráfico muestra duraciones del matrimonio inferiores a cero; actualiza el grafico KDE para que la duración del matrimonio no pueda suavizarse más allá de los puntos de datos extremos.\n\n::: {#fb77fd38 .cell execution_count=36}\n``` {.python .cell-code}\n# Update the KDE plot so that marriage durantion can't be smoothed too far\nsns.kdeplot(data=divorce, x='marriage_duration', hue='num_kids', cut=0)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-37-output-1.png){}\n:::\n:::\n\n\n3. Actualiza el código del gráfico KDE del paso anterior para que muestre una función de distribución acumulativo para cada número de hijos que tiene una pareja.\n\n::: {#5ff45b9b .cell execution_count=37}\n``` {.python .cell-code}\n# Update the KDE plot to show a cumulative distribution function\nsns.kdeplot(data=divorce, x='marriage_duration', hue='num_kids', cut=0, cumulative=True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](03_Relaciones_en_los_datos_files/figure-html/cell-38-output-1.png){}\n:::\n:::\n\n\nParece que hay una correlación positiva entre matrimonios más largos y más hijos, pero por supuesto, esto no indica causalidad. También puedes ver que hay muchos menos datos sobre parejas con más de dos hijos; esto nos ayuda a entender cuan confiables son nuestros hallazgos.\n\n",
    "supporting": [
      "03_Relaciones_en_los_datos_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}